window.__require=function t(e,i,s){function n(a,c){if(!i[a]){if(!e[a]){var r=a.split("/");if(r=r[r.length-1],!e[r]){var h="function"==typeof __require&&__require;if(!c&&h)return h(r,!0);if(o)return o(r,!0);throw new Error("Cannot find module '"+a+"'")}}var l=i[a]={exports:{}};e[a][0].call(l.exports,function(t){return n(e[a][1][t]||t)},l,l.exports,t,e,i,s)}return i[a].exports}for(var o="function"==typeof __require&&__require,a=0;a<s.length;a++)n(s[a]);return n}({bullet:[function(t,e,i){"use strict";cc._RF.push(e,"e656cqs6a5IUJW4+mro0GsR","bullet"),cc.Class({extends:cc.Component,properties:{speed:800,degree:45},start:function(){},shoot_to:function(t){this.degree=t;var e=this.degree*Math.PI/180;this.vx=this.speed*Math.cos(e),this.vy=this.speed*Math.sin(e),this.node.angle=t-90},update:function(t){var e=this.vx*t,i=this.vy*t;this.node.x+=e,this.node.y+=i,(this.node.x<=.5*-cc.winSize.width||this.node.x>=.5*cc.winSize.width||this.node.y<=.5*-cc.winSize.height||this.node.y>=.5*cc.winSize.height)&&this.node.removeFromParent()},onCollisionEnter:function(t,e){console.log("on collision enter");var i=t.tag;window.score=Number(window.score)||0,window.score+=i,this.node.removeFromParent()}}),cc._RF.pop()},{}],cannon:[function(t,e,i){"use strict";cc._RF.push(e,"a5ab4v5SM1ELYlPhyhf9Tht","cannon"),cc.Class({extends:cc.Component,properties:{target:{type:cc.Node,default:null},bullet_prefab:{type:cc.Prefab,default:null},bullet_root:{type:cc.Node,default:null},scoreNum:{type:cc.Label,default:null},gameoeverScore:{type:cc.Label,default:null},bulletNum:{type:cc.Label,default:null},gameoverWindow:{type:cc.Node,default:null},shoot_time:.2},ctor:function(){this.tapTarget={pos:""}},start:function(){this.now_time=this.shoot_time},shoot_bullet:function(t){this.reduce_bullet();var e=this.node.getPosition(),i=t;i=this.node.parent.convertToNodeSpaceAR(i),console.log(i);var s=i.sub(e),n=180*Math.atan2(s.y,s.x)/Math.PI,o=cc.instantiate(this.bullet_prefab);o.getComponent("bullet").shoot_to(n),this.bullet_root.addChild(o),o.setPosition(e),this.node.angle=n-90},update:function(t){if(window.score&&(this.scoreNum.string=window.score),null!==this.target){var e=this.node.getPosition(),i=this.target.getPosition().sub(e),s=180*Math.atan2(i.y,i.x)/Math.PI;this.node.angle=s-90,this.now_time+=t,this.now_time>=this.shoot_time&&(this.shoot_bullet(),this.now_time=0)}},reduce_bullet:function(){Number(this.bulletNum.string)>0?this.bulletNum.string=Number(this.bulletNum.string-1):(cc.director.pause(),this.gameoverWindow.active=!0,this.gameoeverScore.string=this.scoreNum.string)},addScore:function(){}}),cc._RF.pop()},{}],enable_collider:[function(t,e,i){"use strict";cc._RF.push(e,"d65090EZcpKJ6PbKMOwInjY","enable_collider"),cc.Class({extends:cc.Component,properties:{is_enbale:!0,is_debug:!0},onLoad:function(){if(this.is_enbale){var t=cc.director.getCollisionManager();t.enabled=!0,this.is_debug&&(t.enabledDebugDraw=!0)}}}),cc._RF.pop()},{}],fashData_config:[function(t,e,i){"use strict";cc._RF.push(e,"9f992MiWq5PBYG03ggYRJxL","fashData_config");e.exports={fishData:{fish_3:{score:2,lifeValue:1},fish_13:{score:20,lifeValue:5}}},cc._RF.pop()},{}],firstPage:[function(t,e,i){"use strict";cc._RF.push(e,"d35e3RExNNJv7bqWt5B2RXj","firstPage"),cc.Class({extends:cc.Component,properties:{startBtn:{default:null,type:cc.Node},ruleBtn:{default:null,type:cc.Node},gameRules:{default:null,type:cc.Node}},onLoad:function(){cc.director.preloadScene("game_scene",function(t,e,i,s){cc.log("Next scene preloaded")})},start:function(){},startBtnFun:function(){cc.director.loadScene("game_scene")},ruleBtnFun:function(){this.gameRules.active=!0},returnGame:function(t){this.gameRules.active=!1,t.stopPropagation()}}),cc._RF.pop()},{}],fish_map:[function(t,e,i){"use strict";cc._RF.push(e,"20b08EFWzJEj6o2Cz4w8o/1","fish_map"),cc.Class({extends:cc.Component,properties:{is_debug:!1},onLoad:function(){this.anim_com=this.node.getComponent(cc.Animation);var t=this.anim_com.getClips()[0];this.graphics=this.node.addComponent(cc.Graphics),this.graphics.fillColor=cc.color(255,0,0,255);var e,i=t.curveData.paths;for(e in this.road_data_set=[],i){var s=i[e].props.position;this.gen_path_data(s)}this.is_debug&&this.draw_roads()},start:function(){},get_road_set:function(){return this.road_data_set},gen_path_data:function(t){for(var e=null,i=null,s=null,n=null,o=[],a=0;a<t.length;a++){var c=t[a];null!==e&&o.push([i,e,e,cc.v2(c.value[0],c.value[1])]),i=cc.v2(c.value[0],c.value[1]);for(var r=0;r<c.motionPath.length;r++){s=cc.v2(c.motionPath[r][0],c.motionPath[r][1]);n=cc.v2(c.motionPath[r][2],c.motionPath[r][3]),null===e&&(e=n),o.push([i,e,n,s]),e=cc.v2(c.motionPath[r][4],c.motionPath[r][5]),i=s}}console.log(o);for(var h=[o[0][0]],l=0;l<o.length;l++){i=o[l][0],e=o[l][1],n=o[l][2],s=o[l][3];var u=this.bezier_length(i,e,n,s)/16,p=1/(u=Math.floor(u)),_=p;for(a=0;a<u;a++){var d=i.x*(1-_)*(1-_)*(1-_)+3*e.x*_*(1-_)*(1-_)+3*n.x*_*_*(1-_)+s.x*_*_*_,f=i.y*(1-_)*(1-_)*(1-_)+3*e.y*_*(1-_)*(1-_)+3*n.y*_*_*(1-_)+s.y*_*_*_;h.push(cc.v2(d,f)),_+=p}}console.log(h),this.road_data_set.push(h)},draw_roads:function(t){this.graphics.clear();for(var e=0;e<this.road_data_set.length;e++){t=this.road_data_set[e];for(var i=0;i<t.length;i++)this.graphics.moveTo(t[i].x-2,t[i].y+2),this.graphics.lineTo(t[i].x-2,t[i].y-2),this.graphics.lineTo(t[i].x+2,t[i].y-2),this.graphics.lineTo(t[i].x+2,t[i].y+2),this.graphics.close()}this.graphics.fill()},bezier_length:function(t,e,i,s){for(var n=t,o=0,a=.05,c=0;c<20;c++){var r=t.x*(1-a)*(1-a)*(1-a)+3*e.x*a*(1-a)*(1-a)+3*i.x*a*a*(1-a)+s.x*a*a*a,h=t.y*(1-a)*(1-a)*(1-a)+3*e.y*a*(1-a)*(1-a)+3*i.y*a*a*(1-a)+s.y*a*a*a,l=cc.v2(r,h),u=l.sub(n);n=l,o+=u.mag(),a+=.05}return o}}),cc._RF.pop()},{}],frame_anim:[function(t,e,i){"use strict";cc._RF.push(e,"5e39ar17GFLb4FR19LIvlk7","frame_anim"),cc.Class({extends:cc.Component,properties:{sprite_frames:{default:[],type:cc.SpriteFrame},duration:.1,loop:!1,play_onload:!1},onLoad:function(){var t=this.node.getComponent(cc.Sprite);t||(t=this.node.addComponent(cc.Sprite)),this.sprite=t,this.is_playing=!1,this.play_time=0,this.is_loop=!1,this.end_func=null,this.play_onload&&(this.sprite.spriteFrame=this.sprite_frames[0],this.loop?this.play_loop():this.play_once(null))},play_once:function(t){this.play_time=0,this.is_playing=!0,this.is_loop=!1,this.end_func=t},play_loop:function(){this.play_time=0,this.is_playing=!0,this.is_loop=!0},stop_anim:function(){this.play_time=0,this.is_playing=!1,this.is_loop=!1},start:function(){},update:function(t){if(!1!==this.is_playing){this.play_time+=t;var e=Math.floor(this.play_time/this.duration);if(!1===this.is_loop){if(e>=this.sprite_frames.length)return this.sprite.spriteFrame=this.sprite_frames[this.sprite_frames.length-1],this.is_playing=!1,this.play_time=0,void(this.end_func&&this.end_func());this.sprite.spriteFrame=this.sprite_frames[e]}else{for(;e>=this.sprite_frames.length;)e-=this.sprite_frames.length,this.play_time-=this.duration*this.sprite_frames.length;this.sprite.spriteFrame=this.sprite_frames[e]}}}}),cc._RF.pop()},{}],game_mgr:[function(t,e,i){"use strict";cc._RF.push(e,"c3291Rbb8VD5bUuvGD/T65q","game_mgr"),cc.Class({extends:cc.Component,properties:{},start:function(){console.log("start")},update:function(t){}}),cc._RF.pop()},{}],game_scene:[function(t,e,i){"use strict";cc._RF.push(e,"5c060v+7dROvpKSrxxo3hXD","game_scene"),cc.Class({extends:cc.Component,properties:{cannon:{default:null,type:cc.Node}},onLoad:function(){this.node.on("touchstart",function(t){var e=t.getLocation();console.log(e),this.cannon.getComponent("cannon").shoot_bullet(e)},this)},start:function(){}}),cc._RF.pop()},{}],nav_agent:[function(t,e,i){"use strict";cc._RF.push(e,"7b6b09DPO5P1Z/cwuXMt1+E","nav_agent");var s=t("fish_map");cc.Class({extends:cc.Component,properties:{map:{type:s,default:null},speed:100},start:function(){this.run_road()},run_road:function(){var t=this.map.get_road_set(),e=Math.random()*t.length;e=Math.floor(e),this.road_data=t[e],this.road_data.length<2||(this.is_walking=!1,this.node.setPosition(this.road_data[0]),this.next_step=1,this.road_data[0].x<this.road_data[this.road_data.length-1].x?this.node.scaleX=1:this.node.scaleX=-1,this.walk_to_next())},get_next_point:function(){return this.next_step+3>=this.road_data.length?this.road_data[this.road_data.length-1]:this.road_data[this.next_step+3]},walk_to_next:function(){if(this.next_step>=this.road_data.length)return this.is_walking=!1,void this.run_road();this.is_walking=!0;var t=this.node.getPosition(),e=this.road_data[this.next_step].sub(t),i=e.mag();this.total_time=i/this.speed,this.now_time=0,this.vx=this.speed*e.x/i,this.vy=this.speed*e.y/i;var s=180*Math.atan2(e.y,e.x)/Math.PI;s-=90,this.node.angle=s},update:function(t){if(!1!==this.is_walking){this.now_time+=t,this.now_time>this.total_time&&(t-=this.now_time-this.total_time);var e=this.vx*t,i=this.vy*t;this.node.x+=e,this.node.y+=i,this.now_time>=this.total_time&&(this.next_step++,this.walk_to_next())}}}),cc._RF.pop()},{fish_map:"fish_map"}],"use_v2.1.x_cc.Action":[function(t,e,i){"use strict";cc._RF.push(e,"b4dc46oRrlMxJQ/lFfct2zK","use_v2.1.x_cc.Action"),cc.macro.ROTATE_ACTION_CCW=!0,cc._RF.pop()},{}]},{},["use_v2.1.x_cc.Action","bullet","cannon","enable_collider","fish_map","frame_anim","firstPage","game_mgr","fashData_config","game_scene","nav_agent"]);